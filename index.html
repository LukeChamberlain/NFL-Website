<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search API</title>
    <link rel="stylesheet" href="index.css">
    <script>
        async function redeployServer() {
            const apiUrl = "https://api.render.com/deploy/srv-d28f8tre5dus73d73450?key=xhZ_1bBYPf8";
            try {
                const response = await fetch(apiUrl, { method: "POST" });
                if (!response.ok) {
                    console.error("Failed to redeploy server:", response.statusText);
                } else {
                    console.log("Server redeployed successfully.");
                }
            } catch (error) {
                console.error("Error redeploying server:", error.message);
            }
        }
        window.onload = redeployServer;
        async function fetchTeamRoster(teamName) {
            const apiUrl = `https://nfl-website.onrender.com/proxy?team=${encodeURIComponent(teamName)}`;
            
            try {
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error('Roster not found or API error');
                }
                const data = await response.json();
                const resultsDiv = document.getElementById('results');
                
                // Extract roster data
                const rosterHtml = data.teams[0].roster.map(player => `
                    <div class="roster-item">
                        <img src="${player.headshot.replace('{format}', 'f_auto,q_auto')}" alt="${player.name}">
                        <div>
                            <p><strong>${player.name}</strong> (${player.position})</p>
                            <p>Age: ${player.age}</p>
                        </div>
                    </div>
                `).join('');
                
                resultsDiv.innerHTML = `
                    <h2>${teamName} Roster</h2>
                    ${rosterHtml}
                `;
            } catch (error) {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }

        function onTeamSelect() {
            const selectedTeam = document.getElementById('teamDropdown').value;
            if (selectedTeam) {
                fetchTeamRoster(selectedTeam);
            }
        }
    </script>
</head>
<body>
    <div class="banner">
        <h1>Welcome to the demo of my NFL trade website</h1>
        <p>This website is currently underconstruction</p>
    </div>
    <h1>Search NFL Teams</h1>
    <label for="teamDropdown">Select a team:</label>
    <select id="teamDropdown" onchange="onTeamSelect()">
        <option value="">--Select a team--</option>
        <option value="Arizona Cardinals">Arizona Cardinals</option>
        <option value="Atlanta Falcons">Atlanta Falcons</option>
        <option value="Baltimore Ravens">Baltimore Ravens</option>
        <option value="Buffalo Bills">Buffalo Bills</option>
        <option value="Carolina Panthers">Carolina Panthers</option>
        <option value="Chicago Bears">Chicago Bears</option>
        <option value="Cincinnati Bengals">Cincinnati Bengals</option>
        <option value="Cleveland Browns">Cleveland Browns</option>
        <option value="Dallas Cowboys">Dallas Cowboys</option>
        <option value="Denver Broncos">Denver Broncos</option>
        <option value="Detroit Lions">Detroit Lions</option>
        <option value="Green Bay Packers">Green Bay Packers</option>
        <option value="Houston Texans">Houston Texans</option>
        <option value="Indianapolis Colts">Indianapolis Colts</option>
        <option value="Jacksonville Jaguars">Jacksonville Jaguars</option>
        <option value="Kansas City Chiefs">Kansas City Chiefs</option>
        <option value="Las Vegas Raiders">Las Vegas Raiders</option>
        <option value="Los Angeles Chargers">Los Angeles Chargers</option>
        <option value="Los Angeles Rams">Los Angeles Rams</option>
        <option value="Miami Dolphins">Miami Dolphins</option>
        <option value="Minnesota Vikings">Minnesota Vikings</option>
        <option value="New England Patriots">New England Patriots</option>
        <option value="New Orleans Saints">New Orleans Saints</option>
        <option value="New York Giants">New York Giants</option>
        <option value="New York Jets">New York Jets</option>
        <option value="Philadelphia Eagles">Philadelphia Eagles</option>
        <option value="Pittsburgh Steelers">Pittsburgh Steelers</option>
        <option value="San Francisco 49ers">San Francisco 49ers</option>
        <option value="Seattle Seahawks">Seattle Seahawks</option>
        <option value="Tampa Bay Buccaneers">Tampa Bay Buccaneers</option>
        <option value="Tennessee Titans">Tennessee Titans</option>
        <option value="Washington Commanders">Washington Commanders</option>
    </select>
    <div id="results"></div>
</body>
</html>